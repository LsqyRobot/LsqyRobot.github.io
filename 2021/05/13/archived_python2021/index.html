<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/favicon.ico"/>
	<link rel="shortcut icon" href="/img/favicon.ico">
		<!-- Modified by lsqyRobot -->
    <title>
    Beyond The Memory
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="google-site-verification" content="Mbr82TZaQktpHzJ9Wt0AZ4B9JFdVUi1Xjxs8gf20DDM" />
    <link rel="stylesheet" href="/css/lsqy_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="mathematica,robotics,manipulator,ros,vim,matlab,C/C++,python,git,control theory,lsqyRobot" />
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/myCover.png') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

	    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/dytitle.js"></script>
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
    <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
    <script type="text/javascript" src="/js/fireworks.js"></script>
    <script src="/js/codeBlockFuction.js"></script>

<meta name="generator" content="Hexo 7.3.0"></head>
		


<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<body class="is-loading">
    <div id="wrapper" class="fade-in">
        <header id="header">
    <a href="/" class="logo">dots</a>
</header>

        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow"><img src="/img/home.png"></a>
	        </li>

			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1"><img src="/img/folder.png"></a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/ALGORITHM/">ALGORITHM</a></li><li><a class="category-link" href="/categories/C/">C++</a></li><li><a class="category-link" href="/categories/CONFIG/">CONFIG</a></li><li><a class="category-link" href="/categories/CONTROL/">CONTROL</a></li><li><a class="category-link" href="/categories/CPP/">CPP</a></li><li><a class="category-link" href="/categories/GIT/">GIT</a></li><li><a class="category-link" href="/categories/HEXO/">HEXO</a></li><li><a class="category-link" href="/categories/LATEX/">LATEX</a></li><li><a class="category-link" href="/categories/LIFE/">LIFE</a></li><li><a class="category-link" href="/categories/LINUX/">LINUX</a></li><li><a class="category-link" href="/categories/MAC-BOOK/">MAC BOOK</a></li><li><a class="category-link" href="/categories/MATLAB/">MATLAB</a></li><li><a class="category-link" href="/categories/PYTHON/">PYTHON</a></li><li><a class="category-link" href="/categories/ROBOTICS/">ROBOTICS</a></li><li><a class="category-link" href="/categories/ROS/">ROS</a></li><li><a class="category-link" href="/categories/TOOLS/">TOOLS</a></li><li><a class="category-link" href="/categories/dataStruct/">dataStruct</a></li><li><a class="category-link" href="/categories/robotics/">robotics</a>
	                    </ul>
	        </li>
	        


	        <!-- about 关于我   --> 
			<li>
	        
	            <a href="/about/" ><img src="/img/about.png"></a>
	        
			</li>



	        <!-- about 关于我的朋友   --> 
			<li>
	        
	            <a href="/friend/" ><img src="/img/friend.png"></a>
	        
			</li>




	        <!-- about 关于格言   --> 
			<li>
	        
	            <a href="/quote/" ><img src="/img/quote.png"></a>
	        
			</li>


	        <!-- about 关于搜索栏   --> 
			<li>
	        
	            <a href="/search/" ><img src="/img/search.png"></a>
	        
			</li>



	        <!-- my lover--> 
			<li>
	        
	            <a href="/dudu/" ><img src="/img/myLoverLogo.png"></a>
	        
			</li>

	        <!-- my tags--> 
			<li>
	        
			</li>


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
			</ul>
</nav>


        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(/img/postImg/9_Python/venice-4504597_1280.jpg);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >python 学习(二)</h2></a>
            </div>

            <div class="typo" style="padding: 3rem;">
                <!-- vim-markdown-toc GFM -->
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#numpy">Numpy</a><ul>
<li><a href="#ndarray-对象">ndarray 对象</a></li>
</ul>
</li>
<li><a href="#scipy">SciPy</a><ul>
<li><a href="#优化optimize">优化——optimize</a><ul>
<li><a href="#最小二乘拟合">最小二乘拟合</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#pandas">pandas</a><ul>
<li><a href="#series">Series</a></li>
</ul>
</li>
<li><a href="#类函数的编写">类函数的编写</a></li>
<li><a href="#处理矩阵经常用到的">处理矩阵经常用到的</a><ul>
<li><a href="#利用行列向量生成对角阵">利用行列向量生成对角阵</a></li>
</ul>
</li>
<li><a href="#获取xml中的数据">获取xml中的数据</a><pre><code>  * [xml中节点包含的属性：](#xml中节点包含的属性)
  * [节点类型](#节点类型)
  * [python获取xml节点：](#python获取xml节点)
      * [打印标签对之间的数据](#打印标签对之间的数据)
</code></pre></li>
<li><a href="#正则匹配">正则匹配</a><ul>
<li><a href="#正则表达式">正则表达式</a><ul>
<li><a href="#recompile-函数">re.compile 函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#其他">其他</a><ul>
<li><a href="#动态生成变量名">动态生成变量名</a></li>
</ul>
</li>
<li><a href="#小技巧">小技巧</a></li>
<li><a href="#参考">参考</a></li>
</ul>
<!-- vim-markdown-toc -->
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>用python有近一年多的时间了,但水平还是很差,闲来无事,记录一些自己感觉有用的东西,仅此而已。</p>
<h1 id="Numpy"><a href="#Numpy" class="headerlink" title="Numpy"></a>Numpy</h1><h2 id="ndarray-对象"><a href="#ndarray-对象" class="headerlink" title="ndarray 对象"></a>ndarray 对象</h2><p>可以通过给 array()函数传递 Python 的序列 对象来创建数组。数组的形状可以通过其shape 属性获得,它是一个描述数组各个轴长度的元组(tuple)。当设置某个轴的元素个数为-1 时,将自动计算此轴的长度。使用数组的 reshape()方法,可以创建指定形状的新数组,而原数组的形状保持不变。zeros()、ones()、empty()可以创建指定形状和类型的数组。其中：empty()仅仅分配数组所使用的内存,不对数组元素进行初始化操作,因此它的运行速度是最快的。</p>
<p>fromfunction()的第一个参数为计算每个数组元素的函数,第二个参数指定数组的形状。如生成9*9的乘法序列：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fun</span>(<span class="params">i,j</span>):</span><br><span class="line">    <span class="keyword">return</span> (i+<span class="number">1</span>) * (j+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(np.fromfunction(fun, (<span class="number">9</span>,<span class="number">9</span>)))</span><br></pre></td></tr></table></figure>
<p>关于切片,感觉还是利用形象的记忆比较有效,如下图所示</p>
<p><img src="/img/postImg/9_Python/python切片.png" width="100%" height="100%"></p>
<p>标准Python 中有比 for 循环更快的方案——使用列表推导式。但是列表推导式将产生一个新的列表,而不是直接修改原来列表中的元素。如</p>
<figure class="highlight gml"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">x</span> = [math.<span class="built_in">sin</span>(t) <span class="keyword">for</span> t in <span class="variable language_">x</span>]</span><br></pre></td></tr></table></figure>
<h1 id="SciPy"><a href="#SciPy" class="headerlink" title="SciPy"></a>SciPy</h1><p>SciPy在NumPy的基础上增加了众多的数学、科学以及工程计算中常用的模块,例如线性代数、常微分方程数值求解、信号处理、图像处理、稀疏矩阵,等等。</p>
<h2 id="优化——optimize"><a href="#优化——optimize" class="headerlink" title="优化——optimize"></a>优化——optimize</h2><h3 id="最小二乘拟合"><a href="#最小二乘拟合" class="headerlink" title="最小二乘拟合"></a>最小二乘拟合</h3><p>最小二乘是自己做参数辨识中最常用的一种方法了,假设有一组实验数据(xi , yi),我们事先知道它们之间应该满足某函数关系yi=f(xi),通过这些已知信息,需要确定函数f的一些参数。例如,如果函数f是线性函数 f(x)=kx+b,那么参数 k和b 就是需要确定的值。如果用p表示函数中需要确定的参数,那么目标就是找到一组p,使得下面的函数S的值最小：</p>
<script type="math/tex; mode=display">
S(p) = \sum_{i=1}^M[y_i - f(x_i,p)]^2</script><p>这种算法被称为最小二乘拟合(Least-square fitting)。在optimize 模块中,可以使用leastsq()对数据进行最小二乘拟合计算。</p>
<h1 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h1><p>虽然pandas采用了大量的NumPy编码风格,但二者最大的不同是pandas是专门为处理表格和混杂 数据设计的。而NumPy更适合处理统一的数值数组数据。</p>
<p>默认使用使用下面的方式引入pandas:</p>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<p>因为Series和DataFrame用的次数非常 多,所以将其引入本地命名空间中会更方便：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series, DataFrame </span><br></pre></td></tr></table></figure>
<p>要使用pandas,你首先就得熟悉它的两个主要数据结构：Series和DataFrame。</p>
<h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><p>Series是一种类似于一维数组的对象,它由一组数据(各种NumPy数据类型)以及一组与之相关 的数据标签(即索引)组成。仅由一组数据即可产生最简单的Series：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">obj</span> = pd.Series([<span class="number">4</span>, <span class="number">7</span>, -<span class="number">5</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<p>Series的字符串表现形式为：索引在左边,值在右边。由于没有为数据指定索引,于是会自动创建一个0到N-1(N为数据的长度)的整数型索引。可以通过Series 的values和index属性获取其数组表示形式和索引对象：</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">obj.<span class="built_in">values</span></span><br></pre></td></tr></table></figure>
<p>可以通过Series带有可以对各个数据点进行标记的索引：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">obj = pd<span class="selector-class">.Series</span>(<span class="selector-attr">[4, 7, -5, 3]</span>, index=<span class="selector-attr">[<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span>)</span><br></pre></td></tr></table></figure>
<p>这样就可以通过索引的方式选取Series中的单个或一组值, 如：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">obj<span class="selector-attr">[<span class="string">&#x27;a&#x27;</span>]</span></span><br></pre></td></tr></table></figure>
<p>如果数据被存放在一个python字典中,也可以直接通过这个字典来创建Series：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">data</span> = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line"><span class="attr">obj</span> = pd.Series(sdata)</span><br></pre></td></tr></table></figure>
<p>对于许多应用而言,Series最重要的一个功能是,它会根据运算的索引标签自动对齐数据。</p>
<h1 id="类函数的编写"><a href="#类函数的编写" class="headerlink" title="类函数的编写"></a>类函数的编写</h1><p>已自己写的简单的串联机器人的运动学为例,</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">robot</span>:</span><br><span class="line">    def __init__(<span class="keyword">self</span>,theta0,alpha,a,d,beta,tool):</span><br><span class="line">        <span class="keyword">self</span>.theta0 = deg2<span class="title class_ inherited__">Rad</span>(np.array(theta0))  #这里引入了其他地方写的函数,不过非常简单,就是将输入角度变成弧度</span><br><span class="line">        <span class="keyword">self</span>.alpha = deg2<span class="title class_ inherited__">Rad</span>(np.array(alpha))</span><br><span class="line">        <span class="keyword">self</span>.a = np.array(a)</span><br><span class="line">        <span class="keyword">self</span>.d = np.array(d)</span><br><span class="line">        <span class="keyword">self</span>.beta = deg2<span class="title class_ inherited__">Rad</span>(np.array(beta))</span><br><span class="line">        <span class="keyword">self</span>.position = []</span><br><span class="line">        <span class="keyword">self</span>.pose = []</span><br><span class="line">        <span class="keyword">self</span>.<span class="title class_ inherited__">Jacobian</span> = []</span><br><span class="line">        <span class="keyword">self</span>.tool =np.array([[1,0,0,tool[0]],[0,1,0,tool[1]],[0,0,1,tool[2]],[0,0,0,1]])</span><br><span class="line">        np.set_printoptions(suppress=<span class="title class_ inherited__">True</span>)</span><br><span class="line"></span><br><span class="line">    def <span class="title class_ inherited__">FK</span>(<span class="keyword">self</span>,th):</span><br><span class="line">        # 这里theta 的格式为 <span class="title class_ inherited__">N</span>*6, 方便一次性处理</span><br><span class="line">        th = np.array(th).reshape(-1,6)   #主要是担心输入形式为 [0,0,0,0,0,0] 这种格式的</span><br><span class="line">        th = deg2<span class="title class_ inherited__">Rad</span>(th)</span><br><span class="line">        alpha = <span class="keyword">self</span>.alpha</span><br><span class="line">        a = <span class="keyword">self</span>.a</span><br><span class="line">        d = <span class="keyword">self</span>.d</span><br><span class="line">        beta = <span class="keyword">self</span>.beta</span><br><span class="line">        #上面这样写不写,都是无所谓的,追求效率的话,这些代码有很多地方可以优化,不过对于自己处理一些文件,足以。</span><br><span class="line">        axis_z = np.array([0,0,1])</span><br><span class="line">        <span class="title class_ inherited__">T0j</span> = []</span><br><span class="line">        <span class="title class_ inherited__">T0j</span>.append(np.eye(4))</span><br><span class="line">        <span class="keyword">for</span> theta <span class="keyword">in</span> th:</span><br><span class="line">            theta = np.array(theta) + <span class="keyword">self</span>.theta0    #以零点作为基准</span><br><span class="line">            <span class="title class_ inherited__">T</span> = np.eye(4)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(6):</span><br><span class="line">                cth = np.cos(theta[i])</span><br><span class="line">                sth = np.sin(theta[i])</span><br><span class="line">                ca = np.cos(alpha[i])</span><br><span class="line">                sa = np.sin(alpha[i])</span><br><span class="line">                cb = np.cos(beta[i])</span><br><span class="line">                sb = np.sin(beta[i])</span><br><span class="line">                tans =  np.array(   [[cth, -sth * ca, sth * sa, a[i] * cth],</span><br><span class="line">                                     [sth, cth * ca, -cth * sa, a[i] * sth],</span><br><span class="line">                                     [0,   sa,       ca,        d[i]],</span><br><span class="line">                                     [0,   0,         0,         1]])</span><br><span class="line">                rot<span class="title class_ inherited__">Beta</span> = np.array([[cb, 0, sb, 0],</span><br><span class="line">                                    [0, 1, 0, 0],</span><br><span class="line">                                    [-sb, 0, cb, 0],</span><br><span class="line">                                    [0, 0, 0, 1]])					#标准的<span class="title class_ inherited__">DH参数里面</span>,没有用到beta参数,即绕<span class="title class_ inherited__">Y轴旋转的</span>,根据标定的结果为准。</span><br><span class="line">                <span class="title class_ inherited__">A</span> =  np.dot(tans, rot<span class="title class_ inherited__">Beta</span>)</span><br><span class="line">                <span class="title class_ inherited__">T</span> = np.dot(<span class="title class_ inherited__">T</span>,<span class="title class_ inherited__">A</span>)</span><br><span class="line">                <span class="title class_ inherited__">T0j</span>.append(<span class="title class_ inherited__">T</span>)</span><br><span class="line"></span><br><span class="line">            <span class="title class_ inherited__">T0t</span> = np.dot(<span class="title class_ inherited__">T</span>,<span class="keyword">self</span>.tool)</span><br><span class="line">            <span class="keyword">self</span>.position.append(<span class="title class_ inherited__">T0t</span>[:3,3])</span><br><span class="line">            # 求解雅克比矩阵,雅克比矩阵能用到的地方太多了,也太重要了。</span><br><span class="line">            <span class="title class_ inherited__">J</span> = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(6):</span><br><span class="line">                vec_<span class="title class_ inherited__">Z</span> = np.dot(<span class="title class_ inherited__">T0j</span>[i][:3,:3],axis_z)</span><br><span class="line">                <span class="title class_ inherited__">Tjt</span> = np.dot(np.linalg.inv(<span class="title class_ inherited__">T0j</span>[i]),<span class="title class_ inherited__">T0t</span>)</span><br><span class="line">                vec_<span class="title class_ inherited__">P</span> = np.dot(<span class="title class_ inherited__">T0j</span>[i][:3,:3],<span class="title class_ inherited__">Tjt</span>[:3,3])</span><br><span class="line">                <span class="title class_ inherited__">J</span>.append(np.cross(vec_<span class="title class_ inherited__">Z</span>,vec_<span class="title class_ inherited__">P</span>))</span><br><span class="line">            <span class="keyword">self</span>.<span class="title class_ inherited__">Jacobian</span>.append(np.array(<span class="title class_ inherited__">J</span>).transpose())</span><br></pre></td></tr></table></figure>
<p>调用的话,就比较简单了：</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">dhPar = np.array([[ 0,        154,             0,         -90,           0],</span><br><span class="line">                 [-90,          0,       418.865,           0,           0],</span><br><span class="line">                 [  0,          0,       387.265,           0,           0],</span><br><span class="line">                 [ 90,    144.421,             0,          90,           0],</span><br><span class="line">                 [  0,    122.213,             0,          90,           0],</span><br><span class="line">                 [  0,      107.5,             0,           0,           0]])</span><br><span class="line">                 <span class="comment">#输入标定里面的结果</span></span><br><span class="line">theta0 = [0,0,0,0,0,0]  <span class="comment"># 根据具体的标定,去选择修正。 </span></span><br><span class="line">theta0 = dhPar[:,0] - np.array(theta0)</span><br><span class="line">d = dhPar[:,1]</span><br><span class="line">a = dhPar[:,2]</span><br><span class="line">alpha = dhPar[:,3]</span><br><span class="line">beta =  dhPar[:,4]</span><br><span class="line">toolOffset=[44.927,-21.859,62.138]   					 <span class="comment">#工具坐标系</span></span><br><span class="line">yourRobot = robot(theta0,alpha,a,d,beta,toolOffset) 	 <span class="comment">#实例的时候,就会初始化给那些成员函数,和C++非常相似</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">thetaTest = [[-18.417,22.954,97.427,-125.640,108.328,-87.907]]  <span class="comment">#可以写入 N*6 行的关节角,方便一次性在函数体内进行计算</span></span><br><span class="line">ECR5.FK(thetaTest)                                              <span class="comment">#通过正解,可以算出很多结果。</span></span><br><span class="line">print(ECR5.position)											<span class="comment">#输出结果,或者是将结果做下一部的转化、或给其他函数做输入等等。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="处理矩阵经常用到的"><a href="#处理矩阵经常用到的" class="headerlink" title="处理矩阵经常用到的"></a>处理矩阵经常用到的</h1><h2 id="利用行列向量生成对角阵"><a href="#利用行列向量生成对角阵" class="headerlink" title="利用行列向量生成对角阵"></a>利用行列向量生成对角阵</h2><p>这个问题的引入是在自己做辨识的时候用上的,需要将力矩向量变成对角矩阵,然后进行辨识。</p>
<p>大致有三种方法,<code>np.array</code> + <code>np.diag</code>,<code>np.array</code> + <code>np.identity</code>,<code>np.matrix</code> + <code>np.diagflat</code>。其中最快的属于第一种,下面给出第一种的使用：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">tau = np<span class="selector-class">.array</span>(tau)</span><br><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tau))</span><br><span class="line">	tor = np<span class="selector-class">.diag</span>(tau<span class="selector-attr">[i]</span>)</span><br></pre></td></tr></table></figure>
<h1 id="矩阵的合并"><a href="#矩阵的合并" class="headerlink" title="矩阵的合并"></a>矩阵的合并</h1><p>矩阵合并用的最多的是<code>np.append</code>, 比如<code>np.append(m1,m2,axis = 0)</code> 表示合并列,和matlab <code>[a;b]</code>, 很相似,类似的,<code>np.append(m1,m2,axis=1)</code>和 matlab <code>[a,b]</code> 类似,为列合并。</p>
<h1 id="获取xml中的数据"><a href="#获取xml中的数据" class="headerlink" title="获取xml中的数据"></a>获取xml中的数据</h1><p>这个是为了方便自己在读取DH参数的时候用到的。</p>
<h3 id="xml中节点包含的属性："><a href="#xml中节点包含的属性：" class="headerlink" title="xml中节点包含的属性："></a>xml中节点包含的属性：</h3><figure class="highlight mel"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>, nodeName——节点名称</span><br><span class="line"><span class="number">2</span>, nodeValue——节点值</span><br><span class="line"><span class="number">3</span>, <span class="keyword">nodeType</span>——节点类型</span><br><span class="line">   <span class="keyword">nodeType</span>为<span class="number">1</span>说明是元素节点,<span class="keyword">nodeType</span>为<span class="number">2</span>说明是属性节点。</span><br></pre></td></tr></table></figure>
<h3 id="节点类型"><a href="#节点类型" class="headerlink" title="节点类型"></a>节点类型</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">1, 元素节点</span><br><span class="line">2, 文本节点</span><br><span class="line">3, 属性节点</span><br></pre></td></tr></table></figure>
<h3 id="python获取xml节点："><a href="#python获取xml节点：" class="headerlink" title="python获取xml节点："></a>python获取xml节点：</h3><p>DH.xml文件 (简单的例子)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DH</span>&gt;</span>            </span><br><span class="line">        <span class="tag">&lt;<span class="name">Axis1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">theta</span>&gt;</span>0<span class="tag">&lt;/<span class="name">theta</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">d</span>&gt;</span>154.0<span class="tag">&lt;/<span class="name">d</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span>&gt;</span>-0.631<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">alpha</span>&gt;</span>-90.045<span class="tag">&lt;/<span class="name">alpha</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">beta</span>&gt;</span>0<span class="tag">&lt;/<span class="name">beta</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Axis1</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">DH</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>代码：</strong></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">import lsqyRobot as lR</span><br><span class="line">from xml<span class="selector-class">.dom</span> import minidom</span><br><span class="line"></span><br><span class="line">xmlFile = lR<span class="selector-class">.askFileWhere</span>()</span><br><span class="line">dom=minidom<span class="selector-class">.parse</span>(xmlFile)</span><br><span class="line">root=dom<span class="selector-class">.documentElement</span>       #获取dom对象元素</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(root.nodeName)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(root.nodeValue)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(root.nodeType)</span></span></span><br></pre></td></tr></table></figure>
<p>其中 askFilewhere() 在 <code>lsqyRobot.py</code> (为方便自己写的函数包)代码如下</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">def <span class="built_in">askFileWhere</span>():</span><br><span class="line">    root = tk.<span class="built_in">Tk</span>()</span><br><span class="line">    root.<span class="built_in">withdraw</span>()</span><br><span class="line">    file_path = filedialog.<span class="built_in">askopenfilename</span>()</span><br><span class="line">    return file_path</span><br></pre></td></tr></table></figure>
<p>运行结果如下</p>
<p><img src="/img/postImg/9_Python/xmlEx1.png" alt=""></p>
<p>这里如果想在打开文件的时候给予提示,可将 <code>askFileWhere()</code>改写为：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">def <span class="built_in">askFileWhere</span>(tit):</span><br><span class="line">    root = tk.<span class="built_in">Tk</span>()</span><br><span class="line">    root.<span class="built_in">withdraw</span>()</span><br><span class="line">    file_path = filedialog.<span class="built_in">askopenfilename</span>(title = <span class="string">&quot;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(tit))</span><br><span class="line">    return file_path</span><br></pre></td></tr></table></figure>
<h4 id="打印标签对之间的数据"><a href="#打印标签对之间的数据" class="headerlink" title="打印标签对之间的数据"></a>打印标签对之间的数据</h4><figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">node</span>.firstChild.<span class="class"><span class="keyword">data</span></span></span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">import lsqyRobot as lR</span><br><span class="line">from xml.dom import minidom</span><br><span class="line"></span><br><span class="line"><span class="attribute">xmlFile</span> <span class="operator">=</span> lR.askFileWhere()</span><br><span class="line"><span class="attribute">dom</span><span class="operator">=</span>minidom.parse(xmlFile)</span><br><span class="line"><span class="attribute">thetaValue</span> <span class="operator">=</span> dom.getElementsByTagName(<span class="string">&quot;theta&quot;</span>)</span><br><span class="line"><span class="attribute">dValue</span><span class="operator">=</span> dom.getElementsByTagName(<span class="string">&quot;d&quot;</span>)</span><br><span class="line"><span class="attribute">aValue</span><span class="operator">=</span> dom.getElementsByTagName(<span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="attribute">alphaValue</span> <span class="operator">=</span> dom.getElementsByTagName(<span class="string">&quot;alpha&quot;</span>)</span><br><span class="line"><span class="attribute">betaValue</span> <span class="operator">=</span> dom.getElementsByTagName(<span class="string">&quot;beta&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>运行结果如下(调试状态,其实都可以看到值,感兴趣的自己去尝试下,并不难)</p>
<p><img src="/img/postImg/9_Python/xmlEx2.png" alt=""></p>
<p>目前就记录到这,用到再记了。</p>
<h1 id="正则匹配"><a href="#正则匹配" class="headerlink" title="正则匹配"></a>正则匹配</h1><p>事情的起因是要筛选标定程序里的一些点的,由于在标定的时候,自动生成的点位(一般是朝着一个方向,即姿态不怎么发生变化),需要实际去跑这些点位,可有的时候自动生成的点位无法保证是安全的,这样就需要手动去调整,这个时候需要筛选出调整后的点位。比如最后调整好的文件可能是长成这样的：</p>
<p><img src="/img/postImg/9_Python/targetPoint1.png" alt=""></p>
<p>不过只需要里面的数字,就是画黄线那部分,还需要将<code>,</code>,变成<code>Tab</code>, 或者是<code>\t</code>,用 vim 的正则等可以非常快的(大概一分钟)就能解决这个问题, 第一步,除了选中部分,其他部分均删除：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">:v /<span class="tag">&lt;<span class="name">target</span>&gt;</span>/d</span><br></pre></td></tr></table></figure>
<p>通过这一步就差不多把需要的给筛选出来了</p>
<p><img src="/img/postImg/9_Python/targetPoint2.png" alt=""></p>
<p>剩下的就是简单的vim正则替换了:</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">:<span class="variable">%s</span> /&lt;target&gt;POINTJ&lt;<span class="regexp">//g</span>|<span class="variable">%s</span> /)&lt;\/target&gt;<span class="regexp">//g</span>|<span class="variable">%s</span> /,<span class="regexp">/\t/g</span></span><br></pre></td></tr></table></figure>
<p><img src="/img/postImg/9_Python/targetPoint3.png" alt=""></p>
<p><img src="/img/postImg/9_Python/targetPoint4.png" alt=""></p>
<p>这个前提是对 <code>vim</code> 的正则替换有些熟悉,哪怕几百万行,替换的时间也是非常短的,当然,这种核心思想在于正则替换,使用python一样可以做。</p>
<h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><p>正则表达式提供了一种灵活的在文本中搜索或匹配(通常比前者复杂)字符串模式的方式。正则表 达式,常称作regex,是根据正则表达式语言编写的字符串。Python内置的re模块负责对字符串应 用正则表达式。</p>
<p>re模块的函数可以分为三个大类：模式匹配、替换以及拆分。当然,它们之间是相辅相成的。一个 regex描述了需要在文本中定位的一个模式,它可以用于许多目的。</p>
<h3 id="re-compile-函数"><a href="#re-compile-函数" class="headerlink" title="re.compile 函数"></a>re.compile 函数</h3><p>compile 函数用于编译正则表达式,生成一个正则表达式( Pattern )对象,供 match() 和 search() 这两个函数使用。语法格式为：</p>
<figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line">re.compile(pattern[, flags])</span><br><span class="line">pattern : 一个字符串形式的正则表达式</span><br><span class="line">flags : 可选,表示匹配模式,比如忽略大小写,多行模式等,具体参数为：</span><br><span class="line">re.I 忽略大小写</span><br><span class="line">re.L 表示特殊字符集 <span class="string">\w,</span> <span class="string">\W,</span> <span class="string">\b,</span> <span class="string">\B,</span> <span class="string">\s,</span> <span class="string">\S</span> 依赖于当前环境</span><br><span class="line">re.M 多行模式</span><br><span class="line">re.S 即为 . 并且包括换行符在内的任意字符(. 不包括换行符)</span><br><span class="line">re.U 表示特殊字符集 <span class="string">\w,</span> <span class="string">\W,</span> <span class="string">\b,</span> <span class="string">\B,</span> <span class="string">\d,</span> <span class="string">\D,</span> <span class="string">\s,</span> <span class="string">\S</span> 依赖于 Unicode 字符属性数据库</span><br><span class="line">re.X 为了增加可读性,忽略空格和 <span class="comment"># 后面的注释</span></span><br></pre></td></tr></table></figure>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="动态生成变量名"><a href="#动态生成变量名" class="headerlink" title="动态生成变量名"></a>动态生成变量名</h2><p>在我的收藏夹吃灰了好久，收藏的具体原因给忘了，应该不怎么常用</p>
<p>如果你想生成v1,v2…v100这一百个变量，使用其他静态编译语言只能在代码中手动写出这100个变量名，但是在python中可以使用循环方便地动态生成。 python中有一个函数locals()，定义是：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">locals</span>(...)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">locals</span>() -&gt; dictionary</span><br></pre></td></tr></table></figure>
<p>即返回当前作用域的所有变量, 所以可以用这个函数来创建变量</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    name=<span class="string">&#x27;v&#x27;</span>+<span class="built_in">str</span>(i)</span><br><span class="line">    <span class="built_in">locals</span>()<span class="selector-attr">[<span class="string">&#x27;v&#x27;</span>+str(i)]</span>=<span class="selector-tag">i</span></span><br><span class="line"></span><br><span class="line">print v1,v2,v3</span><br></pre></td></tr></table></figure>
<h1 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h1><p>1, 在使用np.array的时候,默认是以科学计数法来显示的,在写机器人代码的时候与示教器上的数值进行核对时,会有些费事,使其正常显示可以设置为</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">np.set_printoptions(<span class="attribute">suppress</span>=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>2, 保存高清图像,指定 <code>dpi</code> 与设置bbox_inches=‘tight’,这里dpi越大,越清晰,当然,导出的时间也越慢。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">plt.savefig(<span class="string">&#x27;./yourPic.jpg&#x27;</span>,<span class="attribute">dpi</span>=500,bbox_inches = <span class="string">&#x27;tight&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>[1] 《python 科学计算》—— 张若愚等著</p>
<p>[2] 《利用 Python 进行数据分析》——Mckinney Wes</p>
<p>[3] <a target="_blank" rel="noopener" href="https://blog.csdn.net/hju22">龟的小号</a></p>
<p>[4] (Python 动态生成变量名)(<a target="_blank" rel="noopener" href="https://blog.csdn.net/Baoli1008/article/details/47980779">https://blog.csdn.net/Baoli1008/article/details/47980779</a>)</p>

            </div>



</div>

   <div class="tag-cloud-tags">
    <a href="/tags/CMakeLists/" style="font-size: 10px; color: #f38181">CMakeLists</a> <a href="/tags/Eigen/" style="font-size: 10px; color: #f38181">Eigen</a> <a href="/tags/FCPX/" style="font-size: 10px; color: #f38181">FCPX</a> <a href="/tags/GNU/" style="font-size: 10px; color: #f38181">GNU</a> <a href="/tags/Gazebo/" style="font-size: 10px; color: #f38181">Gazebo</a> <a href="/tags/Git/" style="font-size: 10px; color: #f38181">Git</a> <a href="/tags/Interest/" style="font-size: 10px; color: #f38181">Interest</a> <a href="/tags/KDL/" style="font-size: 10.91px; color: #ea8a88">KDL</a> <a href="/tags/Life/" style="font-size: 10px; color: #f38181">Life</a> <a href="/tags/Linux/" style="font-size: 10.91px; color: #ea8a88">Linux</a> <a href="/tags/Matrix/" style="font-size: 10px; color: #f38181">Matrix</a> <a href="/tags/ODE/" style="font-size: 10px; color: #f38181">ODE</a> <a href="/tags/QoS/" style="font-size: 10px; color: #f38181">QoS</a> <a href="/tags/ROS/" style="font-size: 12.73px; color: #d99b97">ROS</a> <a href="/tags/Ros/" style="font-size: 10px; color: #f38181">Ros</a> <a href="/tags/UML/" style="font-size: 10px; color: #f38181">UML</a> <a href="/tags/Ubuntu/" style="font-size: 10px; color: #f38181">Ubuntu</a> <a href="/tags/VcXsrv/" style="font-size: 10px; color: #f38181">VcXsrv</a> <a href="/tags/algorithm/" style="font-size: 10px; color: #f38181">algorithm</a> <a href="/tags/algorithms/" style="font-size: 10px; color: #f38181">algorithms</a> <a href="/tags/axis-angle/" style="font-size: 10px; color: #f38181">axis-angle</a> <a href="/tags/bode/" style="font-size: 10px; color: #f38181">bode</a> <a href="/tags/calibration/" style="font-size: 10px; color: #f38181">calibration</a> <a href="/tags/chrome/" style="font-size: 10px; color: #f38181">chrome</a> <a href="/tags/control/" style="font-size: 13.64px; color: #d1a49f">control</a> <a href="/tags/cpp/" style="font-size: 17.27px; color: #afc7bd">cpp</a> <a href="/tags/dB/" style="font-size: 10px; color: #f38181">dB</a> <a href="/tags/data-struct/" style="font-size: 10px; color: #f38181">data_struct</a> <a href="/tags/dots/" style="font-size: 15.45px; color: #c0b5ae">dots</a> <a href="/tags/figure/" style="font-size: 10px; color: #f38181">figure</a> <a href="/tags/gdb/" style="font-size: 10px; color: #f38181">gdb</a> <a href="/tags/git/" style="font-size: 10px; color: #f38181">git</a> <a href="/tags/latex/" style="font-size: 10.91px; color: #ea8a88">latex</a> <a href="/tags/launch/" style="font-size: 10px; color: #f38181">launch</a> <a href="/tags/life/" style="font-size: 16.36px; color: #b7beb5">life</a> <a href="/tags/linux/" style="font-size: 18.18px; color: #a6d0c4">linux</a> <a href="/tags/mac/" style="font-size: 10px; color: #f38181">mac</a> <a href="/tags/math/" style="font-size: 14.55px; color: #c8ada6">math</a> <a href="/tags/matlab/" style="font-size: 11.82px; color: #e29290">matlab</a> <a href="/tags/memory/" style="font-size: 14.55px; color: #c8ada6">memory</a> <a href="/tags/motor/" style="font-size: 10.91px; color: #ea8a88">motor</a> <a href="/tags/moveit/" style="font-size: 10px; color: #f38181">moveit</a> <a href="/tags/operator/" style="font-size: 10px; color: #f38181">operator</a> <a href="/tags/optimal-algorithm/" style="font-size: 10px; color: #f38181">optimal algorithm</a> <a href="/tags/python/" style="font-size: 15.45px; color: #c0b5ae">python</a> <a href="/tags/robot/" style="font-size: 12.73px; color: #d99b97">robot</a> <a href="/tags/robotics/" style="font-size: 14.55px; color: #c8ada6">robotics</a> <a href="/tags/ros/" style="font-size: 15.45px; color: #c0b5ae">ros</a> <a href="/tags/ros2/" style="font-size: 11.82px; color: #e29290">ros2</a> <a href="/tags/rtb/" style="font-size: 10px; color: #f38181">rtb</a> <a href="/tags/simulation/" style="font-size: 10.91px; color: #ea8a88">simulation</a> <a href="/tags/stl/" style="font-size: 10px; color: #f38181">stl</a> <a href="/tags/thread/" style="font-size: 10px; color: #f38181">thread</a> <a href="/tags/tools/" style="font-size: 19.09px; color: #9ed8cc">tools</a> <a href="/tags/twist/" style="font-size: 10px; color: #f38181">twist</a> <a href="/tags/urdf/" style="font-size: 10px; color: #f38181">urdf</a> <a href="/tags/velocity/" style="font-size: 10px; color: #f38181">velocity</a> <a href="/tags/vim/" style="font-size: 14.55px; color: #c8ada6">vim</a> <a href="/tags/web/" style="font-size: 10px; color: #f38181">web</a> <a href="/tags/work/" style="font-size: 20px; color: #95e1d3">work</a> <a href="/tags/wsl/" style="font-size: 10px; color: #f38181">wsl</a>
</div>



<div align="center"> 
    <li id="footer-info-copyright">网站内容采用<a class="external" rel="nofollow noopener" target="_blank" href="https://www.gnu.org/copyleft/fdl.html">GNU自由文档许可证3或更高版本</a>授权</li> <img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="知识共享许可协议">



        </div>
    </div>
</body>


</html>
